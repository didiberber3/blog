---
title: JavaScript 控制结构详解
date: 2024-02-05
author: Didiberber
tags: JavaScript, 基础, 控制结构
---

# JavaScript 控制结构详解

控制结构是编程语言中用来控制程序执行流程的语句。JavaScript 提供了多种控制结构，包括条件语句、循环语句和跳转语句。

## 条件语句

### 1. if 语句

基本的条件判断：

```javascript
let score = 85;

if (score >= 90) {
  console.log("优秀");
} else if (score >= 80) {
  console.log("良好");
} else if (score >= 60) {
  console.log("及格");
} else {
  console.log("不及格");
}
```

### 2. 三元运算符

简洁的条件表达式：

```javascript
let age = 18;
let status = age >= 18 ? "成年人" : "未成年人";

// 嵌套三元运算符（不推荐过度使用）
let grade = score >= 90 ? "A" : score >= 80 ? "B" : score >= 60 ? "C" : "D";
```

### 3. switch 语句

多分支条件判断：

```javascript
let day = new Date().getDay();
let dayName;

switch (day) {
  case 0:
    dayName = "星期日";
    break;
  case 1:
    dayName = "星期一";
    break;
  case 2:
    dayName = "星期二";
    break;
  case 3:
    dayName = "星期三";
    break;
  case 4:
    dayName = "星期四";
    break;
  case 5:
    dayName = "星期五";
    break;
  case 6:
    dayName = "星期六";
    break;
  default:
    dayName = "未知";
}

console.log(dayName);
```

## 循环语句

### 1. for 循环

最常用的循环结构：

```javascript
// 基本 for 循环
for (let i = 0; i < 5; i++) {
  console.log(`第 ${i + 1} 次循环`);
}

// 遍历数组
let fruits = ["苹果", "香蕉", "橙子"];
for (let i = 0; i < fruits.length; i++) {
  console.log(`水果 ${i + 1}: ${fruits[i]}`);
}
```

### 2. for...in 循环

遍历对象的可枚举属性：

```javascript
let person = {
  name: "张三",
  age: 25,
  city: "北京"
};

for (let key in person) {
  console.log(`${key}: ${person[key]}`);
}

// 遍历数组索引（不推荐）
let numbers = [1, 2, 3, 4, 5];
for (let index in numbers) {
  console.log(`索引 ${index}: ${numbers[index]}`);
}
```

### 3. for...of 循环

遍历可迭代对象：

```javascript
// 遍历数组
let colors = ["红色", "绿色", "蓝色"];
for (let color of colors) {
  console.log(color);
}

// 遍历字符串
let text = "Hello";
for (let char of text) {
  console.log(char);
}

// 遍历 Map
let map = new Map([
  ["name", "李四"],
  ["age", 30]
]);
for (let [key, value] of map) {
  console.log(`${key}: ${value}`);
}
```

### 4. while 循环

条件循环：

```javascript
let count = 0;
while (count < 5) {
  console.log(`计数: ${count}`);
  count++;
}

// 实际应用示例
let input = "";
while (input !== "退出") {
  // input = prompt("请输入命令（输入'退出'结束）:");
  // 处理输入
}
```

### 5. do...while 循环

至少执行一次的循环：

```javascript
let number;
do {
  // number = parseInt(prompt("请输入一个正数:"));
  number = Math.floor(Math.random() * 10) - 5; // 模拟输入
  console.log(`输入的数字: ${number}`);
} while (number <= 0);

console.log(`有效的正数: ${number}`);
```

## 跳转语句

### 1. break 语句

跳出循环或 switch：

```javascript
// 在循环中使用 break
for (let i = 0; i < 10; i++) {
  if (i === 5) {
    break; // 跳出循环
  }
  console.log(i);
}

// 在 switch 中使用 break
let grade = "B";
switch (grade) {
  case "A":
    console.log("优秀");
    break;
  case "B":
    console.log("良好");
    break; // 防止继续执行下面的 case
  case "C":
    console.log("及格");
    break;
  default:
    console.log("未知等级");
}
```

### 2. continue 语句

跳过当前循环迭代：

```javascript
// 跳过偶数
for (let i = 0; i < 10; i++) {
  if (i % 2 === 0) {
    continue; // 跳过偶数
  }
  console.log(`奇数: ${i}`);
}

// 过滤数组元素
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
for (let num of numbers) {
  if (num % 3 !== 0) {
    continue; // 跳过不能被3整除的数
  }
  console.log(`能被3整除: ${num}`);
}
```

### 3. 标签语句

用于多层循环的控制：

```javascript
outer: for (let i = 0; i < 3; i++) {
  inner: for (let j = 0; j < 3; j++) {
    if (i === 1 && j === 1) {
      break outer; // 跳出外层循环
    }
    console.log(`i: ${i}, j: ${j}`);
  }
}

// 使用 continue 标签
outer: for (let i = 0; i < 3; i++) {
  for (let j = 0; j < 3; j++) {
    if (j === 1) {
      continue outer; // 继续外层循环的下一次迭代
    }
    console.log(`i: ${i}, j: ${j}`);
  }
}
```

## 现代循环方法

### 1. 数组方法

```javascript
let numbers = [1, 2, 3, 4, 5];

// forEach - 遍历数组
numbers.forEach((num, index) => {
  console.log(`索引 ${index}: ${num}`);
});

// map - 转换数组
let doubled = numbers.map(num => num * 2);
console.log(doubled); // [2, 4, 6, 8, 10]

// filter - 过滤数组
let evenNumbers = numbers.filter(num => num % 2 === 0);
console.log(evenNumbers); // [2, 4]

// find - 查找元素
let found = numbers.find(num => num > 3);
console.log(found); // 4

// some - 检查是否有元素满足条件
let hasEven = numbers.some(num => num % 2 === 0);
console.log(hasEven); // true

// every - 检查是否所有元素都满足条件
let allPositive = numbers.every(num => num > 0);
console.log(allPositive); // true
```

### 2. 对象遍历方法

```javascript
let person = {
  name: "王五",
  age: 28,
  city: "上海"
};

// Object.keys() - 获取所有键
Object.keys(person).forEach(key => {
  console.log(`${key}: ${person[key]}`);
});

// Object.values() - 获取所有值
Object.values(person).forEach(value => {
  console.log(value);
});

// Object.entries() - 获取键值对
Object.entries(person).forEach(([key, value]) => {
  console.log(`${key}: ${value}`);
});
```

## 实际应用示例

### 1. 数据处理

```javascript
let students = [
  { name: "张三", score: 85 },
  { name: "李四", score: 92 },
  { name: "王五", score: 78 },
  { name: "赵六", score: 96 }
];

// 计算平均分
let totalScore = 0;
for (let student of students) {
  totalScore += student.score;
}
let averageScore = totalScore / students.length;
console.log(`平均分: ${averageScore}`);

// 找出优秀学生（分数 >= 90）
let excellentStudents = students.filter(student => student.score >= 90);
console.log("优秀学生:", excellentStudents);
```

### 2. 表单验证

```javascript
function validateForm(formData) {
  let errors = [];
  
  // 检查必填字段
  let requiredFields = ["name", "email", "password"];
  for (let field of requiredFields) {
    if (!formData[field] || formData[field].trim() === "") {
      errors.push(`${field} 是必填字段`);
    }
  }
  
  // 检查邮箱格式
  if (formData.email && !formData.email.includes("@")) {
    errors.push("邮箱格式不正确");
  }
  
  // 检查密码长度
  if (formData.password && formData.password.length < 6) {
    errors.push("密码长度至少6位");
  }
  
  return errors;
}

// 使用示例
let form = {
  name: "张三",
  email: "zhangsan@example.com",
  password: "123456"
};

let validationErrors = validateForm(form);
if (validationErrors.length > 0) {
  console.log("表单验证失败:");
  validationErrors.forEach(error => console.log(`- ${error}`));
} else {
  console.log("表单验证通过");
}
```

## 性能考虑

### 1. 循环优化

```javascript
let arr = new Array(1000000).fill(0);

// 较慢的写法
for (let i = 0; i < arr.length; i++) {
  // 每次都要访问 arr.length
}

// 优化的写法
for (let i = 0, len = arr.length; i < len; i++) {
  // 只计算一次长度
}

// 或者使用 for...of（现代引擎优化很好）
for (let item of arr) {
  // 简洁且性能良好
}
```

### 2. 避免不必要的计算

```javascript
// 不好的做法
for (let i = 0; i < 1000; i++) {
  let expensiveValue = Math.sqrt(1000000); // 重复计算
  console.log(i * expensiveValue);
}

// 好的做法
let expensiveValue = Math.sqrt(1000000); // 只计算一次
for (let i = 0; i < 1000; i++) {
  console.log(i * expensiveValue);
}
```

## 最佳实践

1. **选择合适的循环类型**：
   - 使用 `for...of` 遍历数组
   - 使用 `for...in` 遍历对象属性
   - 使用数组方法（`map`、`filter` 等）进行函数式编程

2. **避免无限循环**：
   - 确保循环条件最终会变为 false
   - 在 while 循环中确保修改控制变量

3. **合理使用 break 和 continue**：
   - 提前退出不必要的循环
   - 跳过不需要处理的情况

4. **保持代码可读性**：
   - 使用有意义的变量名
   - 适当添加注释
   - 避免过度嵌套

---

*掌握控制结构是编程的核心技能，它们决定了程序的执行逻辑和流程控制。*
