---
title: JavaScript 运算符详解
date: 2024-02-15
author: Didiberber
tags: JavaScript, 基础, 运算符
---

# JavaScript 运算符详解

运算符是 JavaScript 中用于执行特定数学和逻辑运算的符号。本文将详细介绍各种类型的运算符及其用法。

## 算术运算符

### 基本算术运算符

```javascript
let a = 10;
let b = 3;

console.log(a + b);  // 13 (加法)
console.log(a - b);  // 7  (减法)
console.log(a * b);  // 30 (乘法)
console.log(a / b);  // 3.3333... (除法)
console.log(a % b);  // 1  (取余)
console.log(a ** b); // 1000 (幂运算，ES2016)
```

### 特殊情况

```javascript
// 字符串连接
console.log("Hello" + " World"); // "Hello World"
console.log("5" + 3);            // "53" (字符串连接)
console.log(5 + "3");            // "53" (字符串连接)

// 类型转换
console.log("5" - 3);   // 2 (数字减法)
console.log("5" * 3);   // 15 (数字乘法)
console.log("5" / 3);   // 1.6666... (数字除法)

// 特殊值
console.log(5 / 0);     // Infinity
console.log(-5 / 0);    // -Infinity
console.log(0 / 0);     // NaN
console.log(5 % 0);     // NaN
```

## 赋值运算符

### 基本赋值

```javascript
let x = 10;
let y = x; // y 的值为 10
```

### 复合赋值运算符

```javascript
let num = 10;

num += 5;  // num = num + 5;  结果: 15
num -= 3;  // num = num - 3;  结果: 12
num *= 2;  // num = num * 2;  结果: 24
num /= 4;  // num = num / 4;  结果: 6
num %= 4;  // num = num % 4;  结果: 2
num **= 3; // num = num ** 3; 结果: 8

console.log(num); // 8
```

### 字符串赋值

```javascript
let message = "Hello";
message += " World";  // message = message + " World"
console.log(message); // "Hello World"
```

## 比较运算符

### 相等性比较

```javascript
// 相等 (==) - 类型转换后比较
console.log(5 == "5");     // true
console.log(true == 1);    // true
console.log(false == 0);   // true
console.log(null == undefined); // true

// 严格相等 (===) - 不进行类型转换
console.log(5 === "5");    // false
console.log(true === 1);   // false
console.log(false === 0);  // false
console.log(null === undefined); // false

// 不相等 (!=) 和严格不相等 (!==)
console.log(5 != "5");     // false
console.log(5 !== "5");    // true
```

### 大小比较

```javascript
let a = 10;
let b = 5;

console.log(a > b);   // true  (大于)
console.log(a < b);   // false (小于)
console.log(a >= b);  // true  (大于等于)
console.log(a <= b);  // false (小于等于)

// 字符串比较（按字典序）
console.log("apple" < "banana");  // true
console.log("Apple" < "apple");   // true (大写字母 ASCII 值小)

// 混合类型比较
console.log("10" > 9);   // true (字符串转为数字)
console.log("10" > "9"); // false (字符串比较)
```

## 逻辑运算符

### 基本逻辑运算符

```javascript
let a = true;
let b = false;

// 逻辑与 (&&)
console.log(a && b);     // false
console.log(true && true); // true

// 逻辑或 (||)
console.log(a || b);     // true
console.log(false || false); // false

// 逻辑非 (!)
console.log(!a);         // false
console.log(!b);         // true
console.log(!!a);        // true (双重否定)
```

### 短路求值

```javascript
// && 短路：如果左侧为假，不执行右侧
let x = 0;
x && console.log("这不会执行"); // x 为假值

let y = 5;
y && console.log("这会执行"); // y 为真值

// || 短路：如果左侧为真，不执行右侧
let name = "张三";
let displayName = name || "匿名用户";
console.log(displayName); // "张三"

let emptyName = "";
let defaultName = emptyName || "匿名用户";
console.log(defaultName); // "匿名用户"
```

### 空值合并运算符 (ES2020)

```javascript
// ?? 只有在左侧为 null 或 undefined 时才返回右侧
let value1 = null ?? "默认值";      // "默认值"
let value2 = undefined ?? "默认值"; // "默认值"
let value3 = 0 ?? "默认值";         // 0
let value4 = "" ?? "默认值";        // ""
let value5 = false ?? "默认值";     // false

// 与 || 的区别
console.log(0 || "默认值");  // "默认值" (0 是假值)
console.log(0 ?? "默认值");  // 0 (0 不是 null/undefined)
```

## 一元运算符

### 递增和递减

```javascript
let num = 5;

// 前置递增/递减
console.log(++num); // 6 (先递增，再返回值)
console.log(--num); // 5 (先递减，再返回值)

// 后置递增/递减
console.log(num++); // 5 (先返回值，再递增)
console.log(num);   // 6
console.log(num--); // 6 (先返回值，再递减)
console.log(num);   // 5
```

### 类型转换运算符

```javascript
// 一元加号 (+) - 转换为数字
console.log(+"5");     // 5
console.log(+true);    // 1
console.log(+false);   // 0
console.log(+"hello"); // NaN

// 一元减号 (-) - 转换为数字并取负
console.log(-"5");     // -5
console.log(-true);    // -1

// typeof 运算符
console.log(typeof 42);        // "number"
console.log(typeof "hello");   // "string"
console.log(typeof true);      // "boolean"
console.log(typeof undefined); // "undefined"
console.log(typeof null);      // "object" (这是一个已知的 bug)
console.log(typeof {});        // "object"
console.log(typeof []);        // "object"
console.log(typeof function(){}); // "function"
```

## 位运算符

### 基本位运算

```javascript
let a = 5;  // 二进制: 101
let b = 3;  // 二进制: 011

console.log(a & b);  // 1 (按位与: 001)
console.log(a | b);  // 7 (按位或: 111)
console.log(a ^ b);  // 6 (按位异或: 110)
console.log(~a);     // -6 (按位非)

// 位移运算
console.log(a << 1); // 10 (左移: 1010)
console.log(a >> 1); // 2  (右移: 10)
console.log(-5 >> 1); // -3 (算术右移，保持符号)
console.log(-5 >>> 1); // 2147483645 (逻辑右移，不保持符号)
```

### 实际应用

```javascript
// 检查奇偶数
function isEven(num) {
  return (num & 1) === 0;
}

console.log(isEven(4)); // true
console.log(isEven(5)); // false

// 权限系统
const PERMISSIONS = {
  READ: 1,    // 001
  WRITE: 2,   // 010
  EXECUTE: 4  // 100
};

let userPermissions = PERMISSIONS.READ | PERMISSIONS.WRITE; // 011

// 检查权限
function hasPermission(permissions, permission) {
  return (permissions & permission) === permission;
}

console.log(hasPermission(userPermissions, PERMISSIONS.READ));  // true
console.log(hasPermission(userPermissions, PERMISSIONS.WRITE)); // true
console.log(hasPermission(userPermissions, PERMISSIONS.EXECUTE)); // false
```

## 条件运算符（三元运算符）

### 基本用法

```javascript
let age = 18;
let status = age >= 18 ? "成年人" : "未成年人";
console.log(status); // "成年人"

// 等价的 if-else 语句
let status2;
if (age >= 18) {
  status2 = "成年人";
} else {
  status2 = "未成年人";
}
```

### 嵌套条件运算符

```javascript
let score = 85;
let grade = score >= 90 ? "A" : 
           score >= 80 ? "B" : 
           score >= 70 ? "C" : 
           score >= 60 ? "D" : "F";

console.log(grade); // "B"

// 更复杂的条件
let weather = "sunny";
let activity = weather === "sunny" ? "去公园" :
               weather === "rainy" ? "在家看书" :
               weather === "snowy" ? "堆雪人" : "待在室内";
```

## 运算符优先级

```javascript
// 运算符优先级示例
let result1 = 2 + 3 * 4;        // 14 (乘法优先级高)
let result2 = (2 + 3) * 4;      // 20 (括号改变优先级)

let result3 = 10 > 5 && 3 < 7;  // true (比较运算符优先级高于逻辑运算符)
let result4 = 10 > 5 || 3 > 7 && 2 < 5; // true (&& 优先级高于 ||)

// 赋值运算符优先级最低
let a, b, c;
a = b = c = 5; // 从右到左赋值
console.log(a, b, c); // 5 5 5
```

### 优先级表（从高到低）

1. `()` 括号
2. `++` `--` `!` `~` `+` `-` (一元运算符)
3. `**` 幂运算
4. `*` `/` `%` 乘除取余
5. `+` `-` 加减
6. `<<` `>>` `>>>` 位移
7. `<` `<=` `>` `>=` 关系比较
8. `==` `!=` `===` `!==` 相等比较
9. `&` 按位与
10. `^` 按位异或
11. `|` 按位或
12. `&&` 逻辑与
13. `||` 逻辑或
14. `??` 空值合并
15. `?:` 条件运算符
16. `=` `+=` `-=` 等赋值运算符

## 特殊运算符

### in 运算符

```javascript
let person = { name: "张三", age: 25 };
let arr = ["a", "b", "c"];

console.log("name" in person);  // true
console.log("height" in person); // false

console.log(0 in arr);  // true (索引 0 存在)
console.log(3 in arr);  // false (索引 3 不存在)
console.log("length" in arr); // true (length 属性存在)
```

### instanceof 运算符

```javascript
let arr = [1, 2, 3];
let date = new Date();
let obj = {};

console.log(arr instanceof Array);   // true
console.log(date instanceof Date);   // true
console.log(obj instanceof Object);  // true
console.log(arr instanceof Object);  // true (Array 继承自 Object)

// 自定义构造函数
function Person(name) {
  this.name = name;
}

let person = new Person("张三");
console.log(person instanceof Person); // true
console.log(person instanceof Object); // true
```

### delete 运算符

```javascript
let obj = { a: 1, b: 2, c: 3 };

delete obj.b;
console.log(obj); // { a: 1, c: 3 }

// 数组中的 delete
let arr = [1, 2, 3, 4, 5];
delete arr[2];
console.log(arr); // [1, 2, empty, 4, 5]
console.log(arr.length); // 5 (长度不变)
```

## 实际应用示例

### 1. 表单验证

```javascript
function validateUser(user) {
  // 使用逻辑运算符进行验证
  let isValid = user && 
                user.name && 
                user.name.length > 0 &&
                user.age && 
                user.age >= 18 &&
                user.email && 
                user.email.includes("@");
  
  return isValid;
}

let user1 = { name: "张三", age: 25, email: "zhangsan@example.com" };
let user2 = { name: "", age: 16, email: "invalid-email" };

console.log(validateUser(user1)); // true
console.log(validateUser(user2)); // false
```

### 2. 默认值设置

```javascript
function greet(name, greeting) {
  // 使用 || 设置默认值
  name = name || "朋友";
  greeting = greeting || "你好";
  
  return `${greeting}, ${name}!`;
}

// 使用 ?? 设置默认值（更精确）
function greetV2(name, greeting) {
  name = name ?? "朋友";
  greeting = greeting ?? "你好";
  
  return `${greeting}, ${name}!`;
}

console.log(greet());           // "你好, 朋友!"
console.log(greet("张三"));     // "你好, 张三!"
console.log(greet("", "嗨"));   // "嗨, 朋友!" (空字符串被视为假值)
console.log(greetV2("", "嗨")); // "嗨, !" (空字符串不被 ?? 替换)
```

### 3. 条件执行

```javascript
// 使用 && 进行条件执行
let user = { isLoggedIn: true, name: "张三" };

user.isLoggedIn && console.log(`欢迎, ${user.name}!`);

// 使用三元运算符进行条件赋值
let theme = localStorage.getItem("theme") || "light";
let backgroundColor = theme === "dark" ? "#333" : "#fff";
let textColor = theme === "dark" ? "#fff" : "#333";
```

### 4. 数据处理

```javascript
let products = [
  { name: "笔记本", price: 5000, discount: 0.1 },
  { name: "鼠标", price: 100, discount: 0 },
  { name: "键盘", price: 300, discount: 0.05 }
];

// 计算最终价格
products.forEach(product => {
  let finalPrice = product.price * (1 - (product.discount || 0));
  console.log(`${product.name}: ¥${finalPrice}`);
});

// 使用位运算进行状态管理
const STATUS = {
  ACTIVE: 1,
  FEATURED: 2,
  ON_SALE: 4,
  NEW: 8
};

let productStatus = STATUS.ACTIVE | STATUS.ON_SALE; // 5 (101)

function hasStatus(status, flag) {
  return (status & flag) === flag;
}

console.log(hasStatus(productStatus, STATUS.ACTIVE));   // true
console.log(hasStatus(productStatus, STATUS.FEATURED)); // false
console.log(hasStatus(productStatus, STATUS.ON_SALE));  // true
```

## 最佳实践

1. **使用严格相等**：优先使用 `===` 和 `!==` 而不是 `==` 和 `!=`
2. **明确优先级**：使用括号明确运算顺序，提高代码可读性
3. **合理使用短路求值**：利用 `&&` 和 `||` 进行条件执行和默认值设置
4. **避免复杂的三元运算符**：嵌套过深时使用 if-else 语句
5. **谨慎使用位运算符**：除非确实需要，否则避免使用位运算符
6. **类型安全**：在 TypeScript 中使用类型检查避免类型相关的错误

---

*运算符是 JavaScript 编程的基础工具，正确理解和使用它们对于编写高效、可读的代码至关重要。*
