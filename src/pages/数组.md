---
title: JavaScript 数组完全指南
date: 2024-02-10
author: Didiberber
tags: JavaScript, 基础, 数组
---

# JavaScript 数组完全指南

数组是 JavaScript 中最重要的数据结构之一，用于存储多个值的有序集合。本文将详细介绍数组的创建、操作和高级用法。

## 数组创建

### 1. 字面量语法（推荐）

```javascript
// 空数组
let emptyArray = [];

// 包含元素的数组
let fruits = ["苹果", "香蕉", "橙子"];
let numbers = [1, 2, 3, 4, 5];
let mixed = ["文本", 42, true, null, { name: "对象" }];
```

### 2. Array 构造函数

```javascript
// 创建空数组
let arr1 = new Array();

// 创建指定长度的数组
let arr2 = new Array(5); // [empty × 5]

// 创建包含元素的数组
let arr3 = new Array("a", "b", "c");

// 注意：单个数字参数会被视为长度
let arr4 = new Array(3); // [empty × 3]
let arr5 = new Array(3.14); // 错误：Invalid array length
```

### 3. Array.from() 方法

```javascript
// 从字符串创建数组
let charArray = Array.from("Hello"); // ["H", "e", "l", "l", "o"]

// 从 NodeList 创建数组
// let divs = Array.from(document.querySelectorAll('div'));

// 使用映射函数
let squares = Array.from({length: 5}, (_, i) => i * i); // [0, 1, 4, 9, 16]

// 从 Set 创建数组
let set = new Set([1, 2, 3, 3, 4]);
let uniqueArray = Array.from(set); // [1, 2, 3, 4]
```

### 4. Array.of() 方法

```javascript
// 解决 Array 构造函数的问题
let arr1 = Array.of(3); // [3]
let arr2 = Array.of(1, 2, 3); // [1, 2, 3]
let arr3 = Array.of(); // []
```

## 数组访问和修改

### 1. 索引访问

```javascript
let fruits = ["苹果", "香蕉", "橙子"];

// 读取元素
console.log(fruits[0]); // "苹果"
console.log(fruits[1]); // "香蕉"
console.log(fruits[-1]); // undefined（负索引不支持）

// 修改元素
fruits[1] = "草莓";
console.log(fruits); // ["苹果", "草莓", "橙子"]

// 添加元素
fruits[3] = "葡萄";
console.log(fruits); // ["苹果", "草莓", "橙子", "葡萄"]
```

### 2. 数组长度

```javascript
let numbers = [1, 2, 3, 4, 5];

// 获取长度
console.log(numbers.length); // 5

// 修改长度（截断数组）
numbers.length = 3;
console.log(numbers); // [1, 2, 3]

// 增加长度（创建空元素）
numbers.length = 5;
console.log(numbers); // [1, 2, 3, empty × 2]
```

## 数组方法

### 1. 添加和删除元素

```javascript
let fruits = ["苹果", "香蕉"];

// push() - 在末尾添加元素
fruits.push("橙子");
fruits.push("葡萄", "草莓");
console.log(fruits); // ["苹果", "香蕉", "橙子", "葡萄", "草莓"]

// pop() - 删除末尾元素
let lastFruit = fruits.pop();
console.log(lastFruit); // "草莓"
console.log(fruits); // ["苹果", "香蕉", "橙子", "葡萄"]

// unshift() - 在开头添加元素
fruits.unshift("柠檬");
console.log(fruits); // ["柠檬", "苹果", "香蕉", "橙子", "葡萄"]

// shift() - 删除开头元素
let firstFruit = fruits.shift();
console.log(firstFruit); // "柠檬"
console.log(fruits); // ["苹果", "香蕉", "橙子", "葡萄"]
```

### 2. splice() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

// 删除元素
let removed = numbers.splice(1, 2); // 从索引1开始删除2个元素
console.log(removed); // [2, 3]
console.log(numbers); // [1, 4, 5]

// 插入元素
numbers.splice(1, 0, 2, 3); // 在索引1处插入2和3
console.log(numbers); // [1, 2, 3, 4, 5]

// 替换元素
numbers.splice(2, 1, 99); // 替换索引2的元素
console.log(numbers); // [1, 2, 99, 4, 5]
```

### 3. slice() 方法

```javascript
let fruits = ["苹果", "香蕉", "橙子", "葡萄", "草莓"];

// 提取子数组（不修改原数组）
let citrus = fruits.slice(1, 3); // 从索引1到3（不包括3）
console.log(citrus); // ["香蕉", "橙子"]
console.log(fruits); // 原数组不变

// 从指定位置到末尾
let lastTwo = fruits.slice(-2);
console.log(lastTwo); // ["葡萄", "草莓"]

// 复制整个数组
let copy = fruits.slice();
console.log(copy); // ["苹果", "香蕉", "橙子", "葡萄", "草莓"]
```

## 数组遍历

### 1. 传统 for 循环

```javascript
let numbers = [1, 2, 3, 4, 5];

for (let i = 0; i < numbers.length; i++) {
  console.log(`索引 ${i}: ${numbers[i]}`);
}
```

### 2. for...of 循环

```javascript
let fruits = ["苹果", "香蕉", "橙子"];

for (let fruit of fruits) {
  console.log(fruit);
}

// 获取索引和值
for (let [index, fruit] of fruits.entries()) {
  console.log(`${index}: ${fruit}`);
}
```

### 3. forEach() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

numbers.forEach((num, index, array) => {
  console.log(`索引 ${index}: ${num}`);
  // array 参数是原数组的引用
});

// 使用箭头函数
numbers.forEach(num => console.log(num * 2));
```

## 数组查找

### 1. indexOf() 和 lastIndexOf()

```javascript
let fruits = ["苹果", "香蕉", "橙子", "香蕉"];

// 查找第一个匹配的索引
let index = fruits.indexOf("香蕉");
console.log(index); // 1

// 查找最后一个匹配的索引
let lastIndex = fruits.lastIndexOf("香蕉");
console.log(lastIndex); // 3

// 未找到返回 -1
let notFound = fruits.indexOf("葡萄");
console.log(notFound); // -1
```

### 2. includes() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

console.log(numbers.includes(3)); // true
console.log(numbers.includes(6)); // false

// 从指定位置开始查找
console.log(numbers.includes(2, 2)); // false（从索引2开始查找）
```

### 3. find() 和 findIndex()

```javascript
let users = [
  { id: 1, name: "张三", age: 25 },
  { id: 2, name: "李四", age: 30 },
  { id: 3, name: "王五", age: 28 }
];

// 查找第一个满足条件的元素
let user = users.find(u => u.age > 26);
console.log(user); // { id: 2, name: "李四", age: 30 }

// 查找第一个满足条件的元素索引
let index = users.findIndex(u => u.name === "王五");
console.log(index); // 2

// 未找到返回 undefined 或 -1
let notFound = users.find(u => u.age > 50);
console.log(notFound); // undefined
```

## 数组转换

### 1. map() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

// 每个元素乘以2
let doubled = numbers.map(num => num * 2);
console.log(doubled); // [2, 4, 6, 8, 10]

// 转换对象数组
let users = [
  { firstName: "张", lastName: "三" },
  { firstName: "李", lastName: "四" }
];

let fullNames = users.map(user => `${user.firstName}${user.lastName}`);
console.log(fullNames); // ["张三", "李四"]
```

### 2. filter() 方法

```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

// 过滤偶数
let evenNumbers = numbers.filter(num => num % 2 === 0);
console.log(evenNumbers); // [2, 4, 6, 8, 10]

// 过滤对象数组
let products = [
  { name: "笔记本", price: 5000, inStock: true },
  { name: "鼠标", price: 100, inStock: false },
  { name: "键盘", price: 300, inStock: true }
];

let availableProducts = products.filter(product => product.inStock);
console.log(availableProducts);
```

### 3. reduce() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

// 计算总和
let sum = numbers.reduce((acc, num) => acc + num, 0);
console.log(sum); // 15

// 计算最大值
let max = numbers.reduce((acc, num) => Math.max(acc, num));
console.log(max); // 5

// 统计字符出现次数
let chars = ['a', 'b', 'a', 'c', 'b', 'a'];
let charCount = chars.reduce((acc, char) => {
  acc[char] = (acc[char] || 0) + 1;
  return acc;
}, {});
console.log(charCount); // { a: 3, b: 2, c: 1 }
```

## 数组排序

### 1. sort() 方法

```javascript
let fruits = ["香蕉", "苹果", "橙子"];

// 默认排序（字符串）
fruits.sort();
console.log(fruits); // ["橙子", "苹果", "香蕉"]

// 数字排序
let numbers = [10, 5, 40, 25, 1000, 1];

// 错误的排序（按字符串排序）
numbers.sort();
console.log(numbers); // [1, 10, 1000, 25, 40, 5]

// 正确的数字排序
numbers.sort((a, b) => a - b);
console.log(numbers); // [1, 5, 10, 25, 40, 1000]

// 降序排序
numbers.sort((a, b) => b - a);
console.log(numbers); // [1000, 40, 25, 10, 5, 1]
```

### 2. reverse() 方法

```javascript
let numbers = [1, 2, 3, 4, 5];

numbers.reverse();
console.log(numbers); // [5, 4, 3, 2, 1]
```

### 3. 复杂排序

```javascript
let students = [
  { name: "张三", score: 85, age: 20 },
  { name: "李四", score: 92, age: 19 },
  { name: "王五", score: 85, age: 21 }
];

// 按分数降序排序
students.sort((a, b) => b.score - a.score);

// 按分数降序，分数相同时按年龄升序
students.sort((a, b) => {
  if (a.score !== b.score) {
    return b.score - a.score; // 分数降序
  }
  return a.age - b.age; // 年龄升序
});

console.log(students);
```

## 数组测试

### 1. some() 和 every()

```javascript
let numbers = [2, 4, 6, 8, 10];

// some() - 检查是否有元素满足条件
let hasEven = numbers.some(num => num % 2 === 0);
console.log(hasEven); // true

let hasOdd = numbers.some(num => num % 2 === 1);
console.log(hasOdd); // false

// every() - 检查是否所有元素都满足条件
let allEven = numbers.every(num => num % 2 === 0);
console.log(allEven); // true

let allPositive = numbers.every(num => num > 0);
console.log(allPositive); // true
```

## 数组合并和展开

### 1. concat() 方法

```javascript
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let arr3 = [7, 8, 9];

// 合并数组
let combined = arr1.concat(arr2, arr3);
console.log(combined); // [1, 2, 3, 4, 5, 6, 7, 8, 9]

// 原数组不变
console.log(arr1); // [1, 2, 3]
```

### 2. 展开运算符

```javascript
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];

// 合并数组
let combined = [...arr1, ...arr2];
console.log(combined); // [1, 2, 3, 4, 5, 6]

// 复制数组
let copy = [...arr1];

// 在数组中插入元素
let inserted = [...arr1, 99, ...arr2];
console.log(inserted); // [1, 2, 3, 99, 4, 5, 6]
```

## 多维数组

```javascript
// 创建二维数组
let matrix = [
  [1, 2, 3],
  [4, 5, 6],
  [7, 8, 9]
];

// 访问元素
console.log(matrix[1][2]); // 6

// 遍历二维数组
for (let i = 0; i < matrix.length; i++) {
  for (let j = 0; j < matrix[i].length; j++) {
    console.log(`matrix[${i}][${j}] = ${matrix[i][j]}`);
  }
}

// 使用 forEach 遍历
matrix.forEach((row, i) => {
  row.forEach((cell, j) => {
    console.log(`matrix[${i}][${j}] = ${cell}`);
  });
});
```

## 实际应用示例

### 1. 数据处理

```javascript
let sales = [
  { product: "笔记本", amount: 5000, month: "1月" },
  { product: "鼠标", amount: 100, month: "1月" },
  { product: "笔记本", amount: 6000, month: "2月" },
  { product: "键盘", amount: 300, month: "2月" }
];

// 计算总销售额
let totalSales = sales.reduce((sum, sale) => sum + sale.amount, 0);
console.log(`总销售额: ${totalSales}`);

// 按产品分组
let productSales = sales.reduce((acc, sale) => {
  if (!acc[sale.product]) {
    acc[sale.product] = 0;
  }
  acc[sale.product] += sale.amount;
  return acc;
}, {});
console.log(productSales);

// 找出销售额最高的产品
let topProduct = Object.entries(productSales)
  .sort(([,a], [,b]) => b - a)[0];
console.log(`销售额最高的产品: ${topProduct[0]} (${topProduct[1]}元)`);
```

### 2. 数组去重

```javascript
let numbers = [1, 2, 2, 3, 3, 3, 4, 5, 5];

// 使用 Set
let unique1 = [...new Set(numbers)];
console.log(unique1); // [1, 2, 3, 4, 5]

// 使用 filter
let unique2 = numbers.filter((num, index) => numbers.indexOf(num) === index);
console.log(unique2); // [1, 2, 3, 4, 5]

// 对象数组去重
let users = [
  { id: 1, name: "张三" },
  { id: 2, name: "李四" },
  { id: 1, name: "张三" }
];

let uniqueUsers = users.filter((user, index, arr) => 
  arr.findIndex(u => u.id === user.id) === index
);
console.log(uniqueUsers);
```

## 性能考虑

### 1. 大数组操作

```javascript
// 避免在循环中使用 push
let arr = [];
for (let i = 0; i < 100000; i++) {
  arr.push(i); // 可能导致多次内存重新分配
}

// 更好的做法：预分配空间
let arr2 = new Array(100000);
for (let i = 0; i < 100000; i++) {
  arr2[i] = i;
}
```

### 2. 选择合适的方法

```javascript
// 查找元素时
let arr = [1, 2, 3, 4, 5];

// 如果只需要检查存在性，使用 includes
if (arr.includes(3)) { /* ... */ }

// 如果需要索引，使用 indexOf
let index = arr.indexOf(3);

// 如果需要复杂条件，使用 find
let found = arr.find(x => x > 3);
```

## 最佳实践

1. **优先使用数组方法**：使用 `map`、`filter`、`reduce` 等方法而不是手写循环
2. **避免修改原数组**：使用不可变方法，如 `slice`、`concat`、展开运算符
3. **合理使用链式调用**：`arr.filter().map().reduce()`
4. **注意性能**：对于大数组，考虑使用适当的算法和数据结构
5. **类型安全**：在 TypeScript 中使用类型注解

---

*数组是 JavaScript 中最强大和常用的数据结构，掌握其各种方法和最佳实践对于高效编程至关重要。*
